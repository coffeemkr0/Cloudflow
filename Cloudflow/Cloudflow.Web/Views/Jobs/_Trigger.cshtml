@model Cloudflow.Web.ViewModels.Jobs.TriggerViewModel
@using Cloudflow.Web.Utility.HtmlHelpers

<div role="tabpanel" class="tab-pane @(Model.Active ? "active" : "")" id="tab@(Model.Id)">
    <ul class="nav nav-tabs">
        <li role="presentation" class="active">
            <a href="#tabTriggerSettings-@Model.Id" role="tab" data-toggle="tab">Settings</a>
        </li>
        <li role="presentation">
            <a href="#tabTriggerConditions-@Model.Id" role="tab" data-toggle="tab">Conditions</a>
        </li>
    </ul>

    <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="tabTriggerSettings-@Model.Id">
            <div id="tab@(Model.Id)" role="tabpanel" class="sortableItem tab-pane @(Model.Active ? "active" : "")">
                <input type="hidden" name="Triggers[@Model.Index].Id"
                       id="Triggers[@Model.Index]_Id"
                       value="@Model.Id" />
                <input type="hidden" name="Triggers[@Model.Index].ExtensionId"
                       id="Triggers[@Model.Index]_ExtensionId"
                       value="@Model.ExtensionId" />
                <input type="hidden" name="Triggers[@Model.Index].ExtensionAssemblyPath"
                       id="Triggers[@Model.Index]_ExtensionAssemblyPath"
                       value="@Model.ExtensionAssemblyPath" />

                <input class="sortableItemPosition" type="hidden" name="Triggers[@Model.Index].Position"
                       id="Triggers[@Model.Index]_Position"
                       value="@Model.Index" />
                <input class="deletedInput" type="hidden" name="Triggers[@Model.Index].Deleted"
                       id="Triggers[@Model.Index]_Deleted"
                       value="@Model.Deleted" />

                @Html.ExtensionConfiguration(Model, "Triggers[" + Model.Index + "]")
            </div>
        </div>

        <div role="tabpanel" class="tab-pane" id="tabTriggerConditions-@Model.Id">
            <section class="container-fluid">
                <div class="col-md-3 panel panel-default">
                    <div class="panel-body">
                        <div>
                            <a data-toggle="modal" data-target="#conditionsExtensionBrowser" data-viewmodelpropertyname="Triggers[@(Model.Index)]"
                               id="btnAddCondition" class="btn btn-default addExtension" href="#">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                                Add Condition...
                            </a>
                        </div>

                        <hr />

                        <ul id="conditionNavigationItems" class="nav nav-pills nav-stacked sortable">
                            @foreach (var condition in Model.Conditions)
                            {
                                @Html.Partial("_ConditionNavigationItem", condition)
                            }
                        </ul>
                    </div>
                </div>

                <div id="conditionConfigurations" class="tab-content col-md-9">
                    @foreach (var condition in Model.Conditions)
                    {
                        @Html.Partial("_ConditionConfiguration", condition)
                    }
                </div>
            </section>
        </div>
    </div>
</div>